<p id="notice"><%= notice %></p>


<div class="page-header reduce-top-margin">

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <h1>Books <span class="glyphicon glyphicon-envelope"></span></h1>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-3">
    <!-- Just an idea <h4>Categories</h4> -->

    <ul class="list-group">
      <% get_categories.each do |category| %>
          <a class="list-group-item" href="<%= category_path(category.id) %>"><%= category.name %>
            <span class="badge"><%= category.books.count %></span></a>
      <% end %>
    </ul>
  </div>


  <div class="col-md-9">

    <div class="panel panel-default">
      <div class="panel-body" id="content-panel">
        <% @books.each do |book| %>
            <div class="well well-sm">

            <%= render :partial => 'books/book', object: book %>
            <% if current_user %>
                <td><%= render 'ratings/form', rating: Rating.new(:book_id => book.id, :user_id => current_user.id) %></td>
            <% end %>

            <!-- comments field -->
            <div class="panel-group" id="accordion<%= book.id %>">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#accordion<%= book.id %>" href="#collapseSix<%= book.id %> ">
                      (<%= book.comments.count %>)
                      Kommentarer <b class="caret"></b>
                    </a>
                  </h4>
                </div>
                <div id="collapseSix<%= book.id %>" class="panel-collapse collapse ">
                  <div id='com<%= book.id %>'>
                    <%= render :partial => 'comments/comment', collection: book.comments %>
                  </div>
                  <% if current_user %>
                      <%= render 'comments/form', comment: Comment.new(:book_id => book.id, :user_id => current_user.id) %>
                  <% end %>
                </div>
              </div>
              </div><!-- end comments field -->
            </div>
            <hr>
        <% end %>

      </div>
    </div>
  </div> <!-- column 9 -->

</div><!-- end of row -->