<p id="notice"><%= notice %></p>


<div class="page-header reduce-top-margin">

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <h1>Books</h1>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-3">
    <!-- Just an idea <h4>Categories</h4> -->

    <ul class="list-group">
      <% get_categories.each do |category| %>
          <a class="list-group-item" href="<%= category_path(category.id) %>"><%= category.name %>
            <span class="badge"><%= category.books.count %></span></a>
      <% end %>
    </ul>
  </div>


  <div class="col-md-9">

    <div class="panel panel-default">
      <div class="panel-body" id="content-panel">
        <% @books.each do |book| %>
            <div class="well well-lg">

              <div class="pull-right">
                <% if current_user %>
                    <%= render 'ratings/form', rating: Rating.new(:book_id => book.id, :user_id => current_user.id) %>
                <% end %>

              </div>
              <br>

              <!-- TODO: can this be outside form? -->
              <!-- end star ratings-->


            <%= render :partial => 'books/book', object: book %>





              <button type="button" class="btn btn-info medium-margin-top" data-toggle="collapse" data-target="#collapse<%= book.id %>">(<b id="commentcount_<%= book.id %>"><%= book.comments.count %></b>)
                Kommentarer <b class="caret"></b></button>
              <!-- comments field -->
                <div id="collapse<%= book.id %>" class="panel-collapse collapse ">
                  <div id='com<%= book.id %>'>
                    <%= render :partial => 'comments/comment', collection: book.comments %>
                  </div>

                  <% if current_user %>
                      <%= render 'comments/form', comment: Comment.new(:book_id => book.id, :user_id => current_user.id) %>
                  <% end %>
                </div>


            </div>
            <hr>
        <% end %>

      </div> <!-- end well -->
    </div>

  </div>
  </div> <!-- column 9 -->
<!-- end of row -->
